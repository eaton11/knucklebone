"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};module.exports=function(){function t(t){var n=u(new XMLHttpRequest);return n.addEventListener("readystatechange",function(r){4===n.readyState&&e(n,t)}),n.open(t.method,t.url),"GET"===t.method?n.send():"json"===obj.contentType?(n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),obj.data instanceof Object?n.send(JSON.stringify(obj.data)):n.send(obj.data)):n.send(obj.data),n}function e(t,e){var s={response:t.response,responseText:t.responseText,responseURL:t.responseURL,status:t.status,statusText:t.statusText};return t.status>=200&&t.status<400?"GET"===e.method&&"json"===e.contentType?n(t,s):r(t,t.response,s):o(t,t.response,s)}function n(t,e){var n=s(t.response);return"object"===("undefined"==typeof n?"undefined":_typeof(n))?r(t,n,e):o(t,"Error parsing response. Expected JSON.",e)}function r(t,e,n){"function"==typeof t._onSuccess&&t._onSuccess(e,n)}function o(t,e,n){"function"==typeof t._onError&&t._onError(e,n)}function s(t){try{var e=JSON.parse(t)}catch(n){return null}return e}function u(t){return t.success=function(e){if("function"!=typeof e)throw Error('callback not passed to "success" method');return t._onSuccess=e,t},t.error=function(e){if("function"!=typeof e)throw Error('callback not passed to "error" method');return t._onError=e,t},t}function i(e,n){if("string"!=typeof e)throw Error("url must be a string");return"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(-1===e.indexOf("?")&&(e+="?"),l.each(Object.keys(n),function(t){e+=t+"="+encodeURIComponent(n[t])})),t({url:e,method:"GET"})}function f(e,n){if("string"!=typeof e)throw Error("url must be a string");return"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(-1===e.indexOf("?")&&(e+="?"),l.each(Object.keys(n),function(t){e+=t+"="+encodeURIComponent(n[t])})),t({url:e,method:"GET",contentType:"json"})}function c(e,n){if("string"!=typeof e)throw Error("url must be a string");return t({url:e,method:"POST",data:n})}function a(e,n){if("string"!=typeof e)throw Error("url must be a string");return t({url:e,method:"POST",data:n,contentType:"json"})}function p(e,n){if("string"!=typeof e)throw Error("url must be a string");return t({url:e,method:"PUT",data:n,contentType:"json"})}function y(e,n){if("string"!=typeof e)throw Error("url must be a string");return t({url:e,method:"DELETE",data:n,contentType:"json"})}function d(t){var e=document.getElementById(t).querySelectorAll("[kb]"),n={};return l.each(e,function(t){if(t.hasAttribute("name")){var e=t.getAttribute("name").trim();if(n[e])throw Error("form name dublicated");n[e]=t.value.trim()}}),n}var l={isArray:function(t){return Array.isArray&&Array.isArray(t)||t.constructor===Array||t instanceof Array},each:function(t,e){if("function"!=typeof e)return t;for(var n=this.isArray(t)?t:this.toArray(t),r=0,o=n.length;o>r;r++)e(n[r])},toArray:function(t){if(!t||!t.length)return[];for(var e=[],n=0;e.length<t.length;)e.push(t[n++]);return e}};return{get:i,getJson:f,post:c,postJson:a,putJson:p,deleteJson:y,formToObject:d}}();
