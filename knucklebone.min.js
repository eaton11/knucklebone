function knucklebone(e){var t={options:{verbose:void 0===e?!1:e.verbose===!0?!0:!1,multi:null,form:!0,requestHeader:void 0===e?null:void 0!==e.requestHeader?e.requestHeader:null,stream:void 0===e?!1:e.stream===!0?!0:!1},abort:function(){self=this;for(var e=0,t=self.utils.queue.length;t>e;e++)self.utils.queue[e]._XMLHttpRequest.abort();return self.utils.info.permissionToFire=!1,self.utils.info.aborted=!0,self},resend:function(){for(var e=0,t=this.utils.queue.length;t>e;e++)null!==this.utils.queue[e]?(this.utils.queue[e]._XMLHttpRequest.abort(),this.utils.newRequest(this.utils.queue[e],this.utils.queue,e)):void 0;return this},pause:function(e){return this.paused=!0,e&&"function"==typeof e&&(this.utils.pause=e),this},play:function(){return this.paused?(this.paused=!1,this.utils.rqst()):void 0,this},response:function(e){return this.utils.response=e,this},success:function(e){return this.utils.success=e,this},error:function(e){return this.utils.error=e,this},get:function(e){return this.utils.prepareCall(e,"get",null,this),this},post:function(t,s){if(e&&e.form===!1);else var s=document.querySelector("[kb-form="+s+"]");this.utils.prepareCall(t,"post",s,this)},utils:{prepareCall:function(s,r,o,n){void 0;var u=this;if("string"==typeof s)t.options.multi=!1,o?(void 0,u.mapCall(s,r,o)):(void 0,u.mapCall(s,r));else if(Array.isArray(s)){t.options.multi=!0;for(var a=0,i=s.length;i>a;a++)o?u.mapCall(s[a],r,o):u.mapCall(s[a],r)}if(t.paused){var l=void 0!==e&&void 0!==e.contentType?e.contentType:"get"===r?"json":"form";"form"===l?o.addEventListener("submit",function(e){e.preventDefault(),u.pause(t)}):u.pause(t)}else u.rqst();return t},mapCall:function(t,s,r){void 0;var o=this,n={url:t,contentType:void 0!==e?e.contentType:"get"===s?"json":"form",timeout:void 0!==e?e.timeout:null,type:s,pending:!0,res:{},aborted:!1,permissionToFire:!0,onSuccess:null,onError:null};"post"===n.type&&(void 0,n.postData=r,n.form=void 0==e?!0:e.form?e.form:!0),void 0,o.queue.push(n)},rqst:function(){for(var e=0,t=this.queue.length;t>e;e++)null!==this.queue[e]&&this.newRequest(this.queue[e],this.queue,e)},newRequest:function(e,s,r){var o=this;e._XMLHttpRequest=new XMLHttpRequest,function(e,s,r,n){s.addEventListener("readystatechange",function(){if(4===s.readyState&&0!==s.status){e.pending=!1,r[n]=null;var u=o.beautifyRes(s,e.url);(u.status>=200&&u.status<300?0:1)?t.options.stream||!t.options.multi?(o.error(u,t),o.response(u,t)):(o.resDataError.push(u),o.resDataAll.push(u)):t.options.stream||!t.options.multi?(o.success(u,t),o.response(u,t)):(o.resDataSuccess.push(u),o.resDataAll.push(u)),o.resDataAll.length===o.queue.length&&(r=[],o.resDataSuccess.each=o.resDataAll.each=o.resDataError.each=function(e){for(var t=this,s=0,r=t.length;r>s;s++)e(t[s],s,t)},o.success(o.resDataSuccess,t),o.error(o.resDataError,t),o.response(o.resDataAll,t))}}),s.addEventListener("timeout",function(){e.pending=!1,r[n]=null;var u=o.beautifyRes(s,e.url);u.responseType=u.statusText="timeout",t.options.stream||!t.options.multi?(o.error(u,t),o.response(u,t)):(o.resDataError.push(u),o.resDataAll.push(u)),o.resDataAll.length===o.queue.length&&(r=[],o.resDataSuccess.each=o.resDataAll.each=o.resDataError.each=function(e){for(var t=this,s=0,r=t.length;r>s;s++)e(t[s],s,t)},o.error(o.resDataError,t),o.response(o.resDataAll,t))})}(e,e._XMLHttpRequest,s,r),e._XMLHttpRequest.open(e.type,e.url),t.options.requestHeader&&e._XMLHttpRequest.setRequestHeader(Object.keys(t.options.requestHeader)[0],t.options.requestHeader[Object.keys(t.options.requestHeader)[0]]),e.timeout&&(e._XMLHttpRequest.timeout=e.timeout),"post"===e.type?(void 0,e._XMLHttpRequest.send(e.form===!0?o.stringifyForm(e.postData):e.postData)):(void 0,e._XMLHttpRequest.send())},beautifyRes:function(t,s){if(void 0!==e&&void 0!==e.beautifyResponse?e.beautifyResponse:!0){var r={};try{r.json=JSON.parse(t.response)}catch(o){r.json=null}return r.query=s,r.response=t.response,r.responseType=t.responseType,r.responseURL=t.responseURL,r.status=t.status,r.statusText=t.statusText,r}return t},stringifyForm:function(e){for(var t=e.querySelectorAll("[kb-name]"),s="",r=0,o=t.length;o>r;r++)s+=encodeURIComponent(t[r].getAttribute("kb-name"))+"="+encodeURIComponent(t[r].value),r!==o-1&&(s+="&");return void 0,s},formify:function(e){var t=new FormData(e);return t},success:function(){},error:function(){},response:function(){},pause:function(){},resDataSuccess:[],resDataError:[],resDataAll:[],queue:[]}};return t}