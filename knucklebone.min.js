"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};module.exports=function(){function e(e,n,o,r){var u=s(new XMLHttpRequest);return u.addEventListener("readystatechange",function(e){4===u.readyState&&t(u,o,n)}),u.open(n,e),"GET"===n?u.send():"json"===o?(u.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r instanceof Object?u.send(JSON.stringify(r)):u.send(r)):u.send(r),u}function t(e,t,s){var u={response:e.response,responseText:e.responseText,responseURL:e.responseURL,status:e.status,statusText:e.statusText};if(e.status>=200&&e.status<400){if("GET"!==s)return n(e,e.response,u);if("json"!==t)return n(e,e.response,u);var c=r(e.response);return null===c?o(e,"Error parsing response. Expected JSON."):n(e,c,u)}return o(e,e.response,u)}function n(e,t,n){"function"==typeof e._onSuccess&&e._onSuccess(t,n)}function o(e,t,n){"function"==typeof e._onError&&e._onError(t,n)}function r(e){try{var t=JSON.parse(e)}catch(n){return null}return t}function s(e){return e.success=function(t){if("function"!=typeof t)throw Error('callback not passed to "success" method');return e._onSuccess=t,this},e.error=function(t){if("function"!=typeof t)throw Error('callback not passed to "error" method');return e._onError=t,this},e}function u(t,n){return"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(t+="?",Object.keys(n).forEach(function(e){t+=e+"="+encodeURIComponent(n[e])})),e(t,"GET")}function c(t,n){return"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(t+="?",Object.keys(n).forEach(function(e){t+=e+"="+encodeURIComponent(n[e])})),e(t,"GET","json")}function f(t,n){return e(t,"POST",void 0,n)}function i(t,n){return e(t,"POST","json",n)}function a(t,n){return e(t,"PUT","json",n)}function p(t,n){return e(t,"DELETE","json",n)}function d(e){for(var t=document.getElementById(e).querySelectorAll("[kb]"),n={},o=0,r=t.length;r>o;o++){if(t[o].hasAttribute("name")){var s=t[o].getAttribute("name").trim();if(n[s])throw Error("form name dublicated");n[s]=t[o].value.trim()}t[o]}return n}return{get:u,getJson:c,post:f,postJson:i,putJson:a,deleteJson:p,formToObject:d}}();
