"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};module.exports=function(){function t(t){var e=u(new XMLHttpRequest);return e.addEventListener("readystatechange",function(n){4===e.readyState&&r(e,t)}),e.open(t.method,t.url),"GET"===t.method?e.send():"json"===t.contentType?(e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.data instanceof Object?e.send(JSON.stringify(t.data)):e.send(t.data)):e.send(t.data),e}function r(t,r){var s={response:t.response,responseText:t.responseText,responseURL:t.responseURL,status:t.status,statusText:t.statusText};return t.status>=200&&t.status<400?"GET"===r.method&&"json"===r.contentType?e(t,s):n(t,t.response,s):o(t,t.response,s)}function e(t,r){var e=s(t.response);return"object"===("undefined"==typeof e?"undefined":_typeof(e))?n(t,e,r):o(t,"Error parsing response. Expected JSON.",r)}function n(t,r,e){"function"==typeof t._onSuccess&&t._onSuccess(r,e)}function o(t,r,e){"function"==typeof t._onError&&t._onError(r,e)}function s(t){try{var r=JSON.parse(t)}catch(e){return null}return r}function u(t){return t.success=function(r){if("function"!=typeof r)throw Error('callback not passed to "success" method');return t._onSuccess=r,t},t.error=function(r){if("function"!=typeof r)throw Error('callback not passed to "error" method');return t._onError=r,t},t}function i(r,e){if("string"!=typeof r)throw Error("url must be a string");return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(-1===r.indexOf("?")&&(r+="?"),m.each(Object.keys(e),function(t){r+=t+"="+encodeURIComponent(e[t])})),t({url:r,method:"GET"})}function f(r,e){if("string"!=typeof r)throw Error("url must be a string");return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(-1===r.indexOf("?")&&(r+="?"),m.each(Object.keys(e),function(t){r+=t+"="+encodeURIComponent(e[t])})),t({url:r,method:"GET",contentType:"json"})}function a(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"POST",data:e})}function c(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"POST",data:e,contentType:"json"})}function p(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"PUT",data:e})}function d(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"PUT",data:e,contentType:"json"})}function y(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"DELETE",data:e})}function l(r,e){if("string"!=typeof r)throw Error("url must be a string");return t({url:r,method:"DELETE",data:e,contentType:"json"})}function h(t){var r=document.getElementById(t).querySelectorAll("[kb]"),e={};return m.each(r,function(t){if(t.hasAttribute("name")){var r=t.getAttribute("name").trim();if(e[r])throw Error("form name dublicated");e[r]=t.value.trim()}}),e}var m={isArray:function(t){return Array.isArray&&Array.isArray(t)||t.constructor===Array||t instanceof Array},each:function(t,r){if("function"!=typeof r)return t;for(var e=this.isArray(t)?t:this.toArray(t),n=0,o=e.length;o>n;n++)r(e[n])},toArray:function(t){if(!t||!t.length)return[];for(var r=[],e=0;r.length<t.length;)r.push(t[e++]);return r}};return{get:i,getJson:f,post:a,postJson:c,put:p,putJson:d,"delete":y,deleteJson:l,formToObject:h}}();
