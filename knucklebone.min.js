function knucklebone(e){var t={options:{verbose:void 0===e?!1:e.verbose===!0?!0:!1,multi:null,form:!0,requestHeader:void 0===e?null:void 0!==e.requestHeader?e.requestHeader:null,stream:void 0===e?!1:e.stream===!0?!0:!1},abort:function(){self=this;for(var e=0,t=self.utils.queue.length;t>e;e++)self.utils.queue[e]._XMLHttpRequest.abort();return self.utils.info.permissionToFire=!1,self.utils.info.aborted=!0,self},resend:function(){for(var e=0,t=this.utils.queue.length;t>e;e++)null!==this.utils.queue[e]?(this.utils.queue[e]._XMLHttpRequest.abort(),this.utils.newRequest(this.utils.queue[e],this.utils.queue,e)):void 0;return this},pause:function(e){return this.paused=!0,this.utils.pause=e,this},play:function(){return this.paused?(this.paused=!1,this.utils.rqst()):void 0,this},response:function(e){return this.utils.response=e,this},success:function(e){return this.utils.success=e,this},error:function(e){return this.utils.error=e,this},get:function(e){return this.utils.prepareCall(e,"get",null,this),this},post:function(e,t){return this.utils.prepareCall(e,"post",t,this),this},utils:{prepareCall:function(s,r,u,n){var o=this;if("string"==typeof s)t.options.multi=!1,o.mapCall(s,r);else if(Array.isArray(s)){t.options.multi=!0;for(var a=0,i=s.length;i>a;a++)u?o.mapCall(s[a],r,u):o.mapCall(s[a],r)}if(t.paused){var l=void 0!==e&&void 0!==e.contentType?e.contentType:"get"===r?"json":"form";"form"===l?u.addEventListener("submit",function(e){e.preventDefault(),o.pause(t)}):o.pause(t)}else o.rqst();return t},mapCall:function(t,s,r){var u=this,n={url:t,contentType:void 0!==e?e.contentType:"get"===s?"json":"form",timeout:void 0!==e?e.timeout:null,type:s,pending:!0,res:{},aborted:!1,permissionToFire:!0,onSuccess:null,onError:null};"post"===n.type&&(n.postData=r,n.form=void 0!==e?e.form:!0),u.queue.push(n)},rqst:function(){for(var e=0,t=this.queue.length;t>e;e++)null!==this.queue[e]&&this.newRequest(this.queue[e],this.queue,e)},newRequest:function(e,s,r){var u=this;e._XMLHttpRequest=new XMLHttpRequest,function(e,s,r,n){s.addEventListener("readystatechange",function(){if(4===s.readyState&&0!==s.status){e.pending=!1,r[n]=null;var o=u.beautifyRes(s,e.url);(o.status>=200&&o.status<300?0:1)?t.options.stream||!t.options.multi?(u.error(o,t),u.response(o,t)):(u.resDataError.push(o),u.resDataAll.push(o)):t.options.stream||!t.options.multi?(u.success(o,t),u.response(o,t)):(u.resDataSuccess.push(o),u.resDataAll.push(o)),u.resDataAll.length===u.queue.length&&(r=[],u.resDataSuccess.each=u.resDataAll.each=u.resDataError.each=function(e){for(var t=this,s=0,r=t.length;r>s;s++)e(t[s],s,t)},u.success(u.resDataSuccess,t),u.error(u.resDataError,t),u.response(u.resDataAll,t))}}),s.addEventListener("timeout",function(){e.pending=!1,r[n]=null;var o=u.beautifyRes(s,e.url);o.responseType=o.statusText="timeout",t.options.stream||!t.options.multi?(u.error(o,t),u.response(o,t)):(u.resDataError.push(o),u.resDataAll.push(o)),u.resDataAll.length===u.queue.length&&(r=[],u.resDataSuccess.each=u.resDataAll.each=u.resDataError.each=function(e){for(var t=this,s=0,r=t.length;r>s;s++)e(t[s],s,t)},u.error(u.resDataError,t),u.response(u.resDataAll,t))})}(e,e._XMLHttpRequest,s,r),e._XMLHttpRequest.open(e.type,e.url),t.options.requestHeader&&e._XMLHttpRequest.setRequestHeader(Object.keys(t.options.requestHeader)[0],t.options.requestHeader[Object.keys(t.options.requestHeader)[0]]),e.timeout&&(e._XMLHttpRequest.timeout=e.timeout),"post"===e.type?e._XMLHttpRequest.send(e.form===!0?u.formify(e.postData):e.postData):e._XMLHttpRequest.send()},beautifyRes:function(t,s){if(void 0!==e&&void 0!==e.beautifyResponse?e.beautifyResponse:!0){var r={};try{r.json=JSON.parse(t.response)}catch(u){r.json=null}return r.query=s,r.response=t.response,r.responseType=t.responseType,r.responseURL=t.responseURL,r.status=t.status,r.statusText=t.statusText,r}return t},formify:function(e){var t=new FormData(e);return t},success:function(){},error:function(){},response:function(){},pause:function(){},resDataSuccess:[],resDataError:[],resDataAll:[],queue:[]}};return t}